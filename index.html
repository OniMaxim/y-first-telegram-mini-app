<script>
        alert('Скрипт начал работу'); // <-- САМЫЙ ПЕРВЫЙ ALERT

        // --- Проверка и использование объекта Telegram ---
        if (typeof Telegram !== 'undefined' && typeof Telegram.WebApp !== 'undefined') {
            alert('Объект Telegram.WebApp НАЙДЕН. Вызываю ready()');
            Telegram.WebApp.ready(); // Сообщаем Telegram, что наше веб-приложение готово
            alert('Telegram.WebApp.ready() выполнен');
        } else {
            alert('ПРЕДУПРЕЖДЕНИЕ: Объект Telegram.WebApp НЕ найден. Это нормально, если страница открыта НЕ ВНУТРИ Telegram.');
        }

        // --- Логика для кнопки "Нажми меня" и абзаца (старый код) ---
        const myHtmlButton = document.getElementById('myHtmlButton');
        const message = document.getElementById('messageParagraph');

        if(myHtmlButton && message){
            myHtmlButton.addEventListener('click', function() {
                message.textContent = 'Миу! Люблю тебя!';
            });
            alert('Старый код для кнопки "Лида" выполнен');
        } else {
            alert('Кнопка "Лида" или абзац для нее не найдены, старый код пропущен');
        }

        // --- НОВЫЙ КОД ДЛЯ ИГРЫ "ЛОПАЙ ШАРИКИ" ---
        alert('Начинается код игры "Лопай Шарики"');

        const bubbles = document.querySelectorAll('.bubble');
        alert('Шарики найдены? Количество: ' + (bubbles ? bubbles.length : 'null или undefined'));

        const resetButton = document.getElementById('resetButton');
        alert('Кнопка сброса найдена? ' + (resetButton ? 'Да' : 'Нет'));

        function popBubble(bubbleElement) {
            if (!bubbleElement.classList.contains('popped')) {
                bubbleElement.classList.add('popped');
                bubbleElement.textContent = 'Чпок!';
            }
        }

        function resetAllBubbles() {
            if (bubbles) { // Добавим проверку, что bubbles существует
                bubbles.forEach(function(bubble) {
                    bubble.classList.remove('popped');
                    bubble.textContent = '';
                });
            }
        }

        if (bubbles && bubbles.length > 0) {
            bubbles.forEach(function(bubble, index) {
                bubble.addEventListener('click', function() {
                    alert('Шарик #' + (index + 1) + ' нажат!');
                    popBubble(bubble);
                });
            });
            alert('Обработчики кликов на шарики добавлены');
        } else {
            alert('Не удалось добавить обработчики на шарики (шарики не найдены или их 0)');
        }

        if (resetButton) {
            resetButton.addEventListener('click', function() {
                alert('Кнопка "Новая упаковка" нажата!');
                resetAllBubbles();
            });
            alert('Обработчик клика на кнопку сброса добавлен');
        } else {
            alert('Не удалось добавить обработчик на кнопку сброса (кнопка не найдена)');
        }

        // --- КОД ДЛЯ TELEGRAM MAINBUTTON (для закрытия приложения) ---
        // Добавим проверку и для этого блока
        if (typeof Telegram !== 'undefined' && typeof Telegram.WebApp !== 'undefined') {
            Telegram.WebApp.MainButton.show();
            Telegram.WebApp.MainButton.setText('Закрыть игру');
            Telegram.WebApp.MainButton.onClick(function() {
                Telegram.WebApp.close();
            });
            alert('Код для Telegram MainButton выполнен');
        } else {
            alert('Код для Telegram MainButton пропущен (Telegram.WebApp не найден)');
        }
        alert('Скрипт завершен (или должен был завершиться)');
    </script>